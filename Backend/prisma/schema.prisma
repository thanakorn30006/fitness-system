
generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model User {
  id        Int      @id @default(autoincrement())    
  name      String
  lastName  String?
  phone     String?
  email     String   @unique
  password  String
  role      Role     @default(MEMBER)
  createdAt DateTime @default(now())

  bookings  Booking[]
  packages  MemberPackage[]
}

model Trainer {
  id        Int      @id @default(autoincrement())    
  name      String
  specialty String
  bio       String?
  imageUrl  String?
  createdAt DateTime @default(now())

  classes   Class[]
}

model Booking {
  id        Int      @id @default(autoincrement())
  userId    Int
  classId   Int
  createdAt DateTime @default(now())

  user      User     @relation(fields: [userId], references: [id], onDelete: Cascade)
  class     Class    @relation(fields: [classId], references: [id], onDelete: Cascade)

  @@unique([userId, classId])

}

enum Role {
  MEMBER
  ADMIN
}

model Class {
  id          Int      @id @default(autoincrement())
  name        String
  description String?
  schedule    DateTime
  capacity    Int
  isActive    Boolean  @default(true)
  trainerId   Int?
  createdAt   DateTime @default(now())

  bookings    Booking[]
  trainer     Trainer? @relation(fields: [trainerId], references: [id])
}

model MemberPackage {
  id        Int      @id @default(autoincrement())
  userId    Int
  packageId  Int
  name      String
  price     Float
  startDate DateTime
  endDate   DateTime
  createdAt DateTime @default(now())

  user      User     @relation(fields: [userId], references: [id], onDelete: Cascade)
  package    Package  @relation(fields: [packageId], references: [id])

}

model Package {
  id          Int      @id @default(autoincrement())
  name        String
  price       Float
  duration    Int     
  description String?
  isActive    Boolean  @default(true)
  createdAt   DateTime @default(now())

  members     MemberPackage[]
}
